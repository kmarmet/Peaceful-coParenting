{
  "version": 3,
  "file": "pushAlert.js",
  "sourceRoot": "\\",
  "sources": [
    "pushAlert.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Import required modules\r\nimport NotificationManager from \"../managers/notificationManager\"\r\nimport Manager from \"../managers/manager\"\r\n# Define PushAlertApi object\r\nPushAlertApi =\r\n# Define line break constant\r\n  lineBreak: '\\r\\n'\r\n\r\n# Define message templates\r\n  templates:\r\n# Template for event tomorrow reminder\r\n    eventIsTomorrowReminder: (event) ->\r\n      \"#{event.title} is tomorrow #{if Manager.isValid(event.fromTime) then '@ ' + event.fromTime else ''}\"\r\n\r\n# Template for event in an hour reminder\r\n    eventIsInAnHourReminder: (event) ->\r\n      \"#{event.title} is in 1 hour\"\r\n\r\n# Template for event in half hour reminder\r\n    eventIsInHalfHourReminder: (event) ->\r\n      \"#{event.title} is in 30 minutes\"\r\n\r\n# Template for update reminder\r\n    updateReminder: ->\r\n      'Visit New Updates in the menu to learn more'\r\n\r\n# Template for swap request decision\r\n    swapRequestApproval: (request, recipientName) ->\r\n      \"Swap Request decision for #{request.startDate} has been APPROVED by #{recipientName}#{PushAlertApi.lineBreak}#{PushAlertApi.lineBreak}\"\r\n\r\n    swapRequestRejection: (request, recipientName) ->\r\n      \"Swap Request for #{request.startDate} has been REJECTED.#{PushAlertApi.lineBreak}#{PushAlertApi.lineBreak} Reason: #{request.reason}. If you would still prefer to proceed with the request,\r\n  you can communicate with #{recipientName} to come to an agreement on the request.\"\r\n\r\n    transferRequestApproval: (request, recipientName) ->\r\n      \"Transfer Change Request decision for #{request.date} has been APPROVED by #{recipientName}#{PushAlertApi.lineBreak}#{PushAlertApi.lineBreak}\"\r\n\r\n    transferRequestRejection: (request, recipientName) ->\r\n      \"Transfer Change Request for #{request.date} has been REJECTED.#{PushAlertApi.lineBreak}#{PushAlertApi.lineBreak} Reason: #{request.reason}. If you would still prefer to proceed with the\r\n request, you can communicate with #{recipientName} to come to an agreement on the request.\"\r\n\r\n# Determine API URL based on environment\r\n  apiUrl: ->\r\n    if location.hostname is 'localhost'\r\n      'http://localhost:3002'\r\n    else\r\n      'https://www.peaceful-coparenting.com'\r\n\r\n# Send message to all users\r\n  sendToAll: (title, message) ->\r\n    fetch 'https://peaceful-coparenting.app:5000/messaging/sendToAll',\r\n      method: 'POST'\r\n      mode: 'no-cors'\r\n      body: JSON.stringify\r\n        title: title\r\n        message: message\r\n\r\n# Manually Trigger Subscribe Alert\r\n  showSubscribeAlert: () ->\r\n    window.pushalertbyiw ?= []\r\n    window.pushalertbyiw.push ['onReady', onPAReady]\r\n    onPAReady = ->\r\n      PushAlertCo.forceSubscribe\r\n#    onPAReady = ->\r\n#      PushAlertCo.triggerMe true\r\n\r\n  # Subscribe a user to push notifications\r\n  subscribeUser: (userPhone) ->\r\n    myHeaders = new Headers()\r\n    myHeaders.append 'Content-Type', 'application/json'\r\n    myHeaders.append 'Authorization', '461dafa18ed1684310b34ae8d00f746e'\r\n    myHeaders.append 'Access-Control-Allow-Origin', '*'\r\n\r\n    urlToUse = 'https://api.pushalert.co/rest/v1/segment/38837/add'\r\n\r\n    requestOptions =\r\n      method: 'POST'\r\n      mode: 'no-cors'\r\n      headers: myHeaders\r\n      body: JSON.stringify\r\n        subscibers: [userPhone]\r\n      redirect: 'follow'\r\n\r\n    fetch(urlToUse, requestOptions)\r\n      .then (result) -> console.log result\r\n      .catch (error) -> console.error error\r\n\r\n# Send a message to a specific user\r\n  sendMessage: (title, message, subId) ->\r\n    myHeaders = new Headers()\r\n    myHeaders.append 'Access-Control-Allow-Headers', 'Content-Type, x-requested-with'\r\n    myHeaders.append 'Access-Control-Allow-Origin', '*'\r\n    subIdToUse = subId\r\n    urlToUse = 'https://peaceful-coparenting.app:5000/messaging/sendMessage'\r\n\r\n    urlencoded = new URLSearchParams()\r\n    urlencoded.append 'title', title\r\n    urlencoded.append 'url', 'https://www.peaceful-coparenting.com'\r\n    urlencoded.append 'message', message\r\n    urlencoded.append 'subscriber', subIdToUse\r\n\r\n    requestOptions =\r\n      method: 'POST'\r\n      mode: 'no-cors'\r\n      headers: myHeaders\r\n      body: urlencoded\r\n      redirect: 'follow'\r\n    console.log(subIdToUse)\r\n    console.log(myHeaders)\r\n    console.log(urlToUse)\r\n    fetch(urlToUse, requestOptions)\r\n      .then (result) -> console.log \"Sent to: #{subIdToUse}\"\r\n      .catch (error) -> console.error error\r\n\r\n# Get subscriber ID for a user\r\n  getSubId: (userPhone) ->\r\n    await NotificationManager.getUserSubId(userPhone)\r\n\r\n# Export PushAlertApi object\r\nexport default PushAlertApi"
  ]
}